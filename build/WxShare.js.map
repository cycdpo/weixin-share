{"version":3,"sources":["webpack://WxShare/webpack/universalModuleDefinition","webpack://WxShare/webpack/bootstrap","webpack://WxShare/./node_modules/awesome-js-funcs/designPattern/CreateInstance.js","webpack://WxShare/./node_modules/object-assign/index.js","webpack://WxShare/./src/index.js"],"names":["_instance","WX_JSSDK_URL","WxShare","isConfigReady","wx","wxConfig","readyCallBack","defaultShare","title","desc","link","window","location","href","replace","imgUrl","_isInitDefaultShare","config","debug","appId","timestamp","nonceStr","signature","jsApiList","setReadyCallBack","setDefaultShare","share","shareData","console","log","Promise","resolve","then","_initWxSDK","_ready","onMenuShareAppMessage","onMenuShareTimeline","onMenuShareQQ","onMenuShareQZone","onMenuShareWeibo","backToDefault","_setWX","oScript","document","createElement","type","onload","src","querySelector","appendChild","ready"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;ACbD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,kCAAkC;AAClC;AACA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,gBAAgB,sBAAsB;AACtC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,oBAAoB;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;ACzFA;AAAA;AAAA;CAGA;;AACA;;AAEA,IACEA,SAAS,GAAG,IAAI,qFAAJ,EA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","file":"WxShare.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WxShare\"] = factory();\n\telse\n\t\troot[\"WxShare\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","/**\r\n * 单例模式构造函数(设计模式)\r\n * @returns {function(*=)}\r\n * @constructor\r\n */\r\nexport default (function () {\r\n  var instance = void 0;\r\n  return function (newInstance) {\r\n    if (newInstance) {\r\n      instance = newInstance;\r\n    }\r\n    return instance;\r\n  };\r\n});","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","// constructor\r\nimport CreateInstance from 'awesome-js-funcs/designPattern/CreateInstance';\r\n\r\n// polyfill\r\nimport objectAssign from 'object-assign';\r\n\r\nlet\r\n  _instance = new CreateInstance()\r\n;\r\n\r\nconst WX_JSSDK_URL = 'https://res.wx.qq.com/open/js/jweixin-1.3.2.js';\r\n\r\nexport default class WxShare {\r\n  constructor() {\r\n    if (_instance()) {\r\n      return _instance();\r\n    }\r\n    this.isConfigReady = false;\r\n    this.wx = null;\r\n    this.wxConfig = null;\r\n    this.readyCallBack = null;\r\n\r\n    this.defaultShare = {\r\n      title: '',\r\n      desc: '',\r\n      link: window.location.href.replace(/(\\?|#).*/g, ''),\r\n      imgUrl: '',\r\n    };\r\n    this._isInitDefaultShare = false;\r\n\r\n    _instance(this);\r\n  };\r\n\r\n  /**\r\n   * config\r\n   * @param configData\r\n   * {\r\n   *  debug: false,\r\n   *  appId: '',\r\n   *  timestamp: 0,\r\n   *  nonceStr: '',\r\n   *  signature: '',\r\n   *  jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareQQ', 'onMenuShareQZone', 'onMenuShareWeibo'],\r\n   * }\r\n   */\r\n  config({\r\n           debug = false,\r\n           appId,\r\n           timestamp,\r\n           nonceStr,\r\n           signature,\r\n           jsApiList = [\r\n             'onMenuShareTimeline',\r\n             'onMenuShareAppMessage',\r\n             'onMenuShareQQ',\r\n             'onMenuShareQZone',\r\n             'onMenuShareWeibo'\r\n           ]\r\n         }) {\r\n    this.wxConfig = {\r\n      debug: debug,\r\n      appId: appId,\r\n      timestamp: timestamp,\r\n      nonceStr: nonceStr,\r\n      signature: signature,\r\n      jsApiList: jsApiList\r\n    };\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * setReadyCallBack\r\n   * @param readyCallBack\r\n   * @return {WxShare}\r\n   */\r\n  setReadyCallBack(readyCallBack = () => {\r\n  }) {\r\n    this.readyCallBack = readyCallBack;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * setDefaultShare\r\n   * @param defaultShare\r\n   * @return {WxShare}\r\n   */\r\n  setDefaultShare(defaultShare = {}) {\r\n    this.defaultShare = objectAssign({}, this.defaultShare, defaultShare);\r\n    this._isInitDefaultShare = true;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * share\r\n   * @param shareData\r\n   *  {\r\n   *    imgUrl: '',\r\n   *    link: '',\r\n   *    title: '',\r\n   *    desc: '',\r\n   *    type: '',  music/video/link(default)\r\n   *    dataUrl: '', if music/video type\r\n   *    trigger:() => {},\r\n   *    success:() => {},\r\n   *    cancel:() => {},\r\n   *    fail:() => {},\r\n   *  }\r\n   */\r\n  share(shareData = {}) {\r\n    if(!this._isInitDefaultShare) {\r\n      this.setDefaultShare(shareData);\r\n    } else {\r\n      shareData = objectAssign({}, this.defaultShare, shareData);\r\n    }\r\n\r\n    console.log(shareData);\r\n\r\n    return Promise.resolve()\r\n      .then(() => this._initWxSDK())\r\n      .then(() => this._ready())\r\n      .then(() => {\r\n        this.wx.onMenuShareAppMessage(shareData);\r\n        this.wx.onMenuShareTimeline(shareData);\r\n        this.wx.onMenuShareQQ(shareData);\r\n        this.wx.onMenuShareQZone(shareData);\r\n        this.wx.onMenuShareWeibo(shareData);\r\n      });\r\n  };\r\n\r\n  /**\r\n   * backToDefault\r\n   * @return {*}\r\n   */\r\n  backToDefault() {\r\n    return this.share();\r\n  };\r\n\r\n  /**\r\n   * init Wechat JSSDK\r\n   * @return {Promise<any>}\r\n   * @private\r\n   */\r\n  _initWxSDK() {\r\n    return new Promise(resolve => {\r\n      let _setWX = () => {\r\n        console.log('set wx');\r\n        let oScript = document.createElement(\"script\");\r\n        oScript.type = \"text/javascript\";\r\n        oScript.onload = () => {\r\n          this.wx = window.wx;\r\n          resolve();\r\n        };\r\n        oScript.src = WX_JSSDK_URL;\r\n        document.querySelector('head').appendChild(oScript);\r\n      };\r\n\r\n      if (this.wx) {\r\n        resolve();\r\n      } else {\r\n        if (window.wx) {\r\n          console.log('has wx');\r\n          this.wx = window.wx;\r\n          resolve();\r\n        } else {\r\n          _setWX();\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  /**\r\n   * set wx.config\r\n   * @return {Promise<any>}\r\n   * @private\r\n   */\r\n  _ready() {\r\n    return new Promise(resolve => {\r\n      if (this.isConfigReady) {\r\n        resolve();\r\n      } else {\r\n        console.log('set wx.config');\r\n        this.wx.config(this.wxConfig);\r\n\r\n        this.wx.ready(() => {\r\n          this.isConfigReady = true;\r\n\r\n          if (this.readyCallBack) {\r\n            this.readyCallBack();\r\n          }\r\n\r\n          resolve();\r\n        });\r\n      }\r\n    });\r\n  };\r\n};\r\n\r\n\r\n"],"sourceRoot":""}