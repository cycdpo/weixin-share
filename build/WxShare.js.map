{"version":3,"sources":["webpack://WxShare/webpack/universalModuleDefinition","webpack://WxShare/webpack/bootstrap","webpack://WxShare/./node_modules/awesome-js-funcs/designPattern/CreateInstance.js","webpack://WxShare/./src/assign.polyfill.js","webpack://WxShare/./src/index.js"],"names":["Object","assign","defineProperty","value","target","varArgs","TypeError","to","index","arguments","length","nextSource","nextKey","prototype","hasOwnProperty","call","writable","configurable","_instance","WX_JSSDK_URL","WxShare","isConfigReady","wx","wxConfig","readyCallBack","defaultShare","title","desc","link","window","location","href","replace","imgUrl","_isInitDefaultShare","config","debug","appId","timestamp","nonceStr","signature","jsApiList","setReadyCallBack","setDefaultShare","share","shareData","console","log","Promise","resolve","then","_initWxSDK","_ready","onMenuShareAppMessage","onMenuShareTimeline","onMenuShareQQ","onMenuShareQZone","onMenuShareWeibo","backToDefault","_setWX","oScript","document","createElement","type","onload","src","querySelector","appendChild","ready"],"mappings":"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","file":"WxShare.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WxShare\"] = factory();\n\telse\n\t\troot[\"WxShare\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","/**\r\n * 单例模式构造函数(设计模式)\r\n * @returns {function(*=)}\r\n * @constructor\r\n */\r\nexport default (function () {\r\n  var instance = void 0;\r\n  return function (newInstance) {\r\n    if (newInstance) {\r\n      instance = newInstance;\r\n    }\r\n    return instance;\r\n  };\r\n});","if (typeof Object.assign != 'function') {\r\n  // Must be writable: true, enumerable: false, configurable: true\r\n  Object.defineProperty(Object, \"assign\", {\r\n    value: function assign(target, varArgs) { // .length of function is 2\r\n      'use strict';\r\n      if (target == null) { // TypeError if undefined or null\r\n        throw new TypeError('Cannot convert undefined or null to object');\r\n      }\r\n\r\n      var to = Object(target);\r\n\r\n      for (var index = 1; index < arguments.length; index++) {\r\n        var nextSource = arguments[index];\r\n\r\n        if (nextSource != null) { // Skip over if undefined or null\r\n          for (var nextKey in nextSource) {\r\n            // Avoid bugs when hasOwnProperty is shadowed\r\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n              to[nextKey] = nextSource[nextKey];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return to;\r\n    },\r\n    writable: true,\r\n    configurable: true\r\n  });\r\n}","// constructor\r\nimport CreateInstance from 'awesome-js-funcs/designPattern/CreateInstance';\r\n\r\n// polyfill\r\nimport 'assign.polyfill';\r\n\r\nlet\r\n  _instance = new CreateInstance()\r\n;\r\n\r\nconst WX_JSSDK_URL = 'https://res.wx.qq.com/open/js/jweixin-1.2.0.js';\r\n\r\nexport default class WxShare {\r\n  constructor() {\r\n    if (_instance()) {\r\n      return _instance();\r\n    }\r\n    this.isConfigReady = false;\r\n    this.wx = null;\r\n    this.wxConfig = null;\r\n    this.readyCallBack = null;\r\n\r\n    this.defaultShare = {\r\n      title: '',\r\n      desc: '',\r\n      link: window.location.href.replace(/(\\?|#).*/g, ''),\r\n      imgUrl: '',\r\n    };\r\n    this._isInitDefaultShare = false;\r\n\r\n    _instance(this);\r\n  };\r\n\r\n  /**\r\n   * config\r\n   * @param configData\r\n   * {\r\n   *  debug: false,\r\n   *  appId: '',\r\n   *  timestamp: 0,\r\n   *  nonceStr: '',\r\n   *  signature: '',\r\n   *  jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareQQ', 'onMenuShareQZone', 'onMenuShareWeibo'],\r\n   * }\r\n   */\r\n  config({\r\n           debug = false,\r\n           appId,\r\n           timestamp,\r\n           nonceStr,\r\n           signature,\r\n           jsApiList = [\r\n             'onMenuShareTimeline',\r\n             'onMenuShareAppMessage',\r\n             'onMenuShareQQ',\r\n             'onMenuShareQZone',\r\n             'onMenuShareWeibo'\r\n           ]\r\n         }) {\r\n    this.wxConfig = {\r\n      debug: debug,\r\n      appId: appId,\r\n      timestamp: timestamp,\r\n      nonceStr: nonceStr,\r\n      signature: signature,\r\n      jsApiList: jsApiList\r\n    };\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * setReadyCallBack\r\n   * @param readyCallBack\r\n   * @return {WxShare}\r\n   */\r\n  setReadyCallBack(readyCallBack = () => {\r\n  }) {\r\n    this.readyCallBack = readyCallBack;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * setDefaultShare\r\n   * @param defaultShare\r\n   * @return {WxShare}\r\n   */\r\n  setDefaultShare(defaultShare = {}) {\r\n    this.defaultShare = Object.assign({}, this.defaultShare, defaultShare);\r\n    this._isInitDefaultShare = true;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * share\r\n   * @param shareData\r\n   *  {\r\n   *    imgUrl: '',\r\n   *    link: '',\r\n   *    title: '',\r\n   *    desc: '',\r\n   *    type: '',  music/video/link(default)\r\n   *    dataUrl: '', if music/video type\r\n   *    trigger:() => {},\r\n   *    success:() => {},\r\n   *    cancel:() => {},\r\n   *    fail:() => {},\r\n   *  }\r\n   */\r\n  share(shareData = {}) {\r\n    if(!this._isInitDefaultShare) {\r\n      this.setDefaultShare(shareData);\r\n    } else {\r\n      shareData = Object.assign({}, this.defaultShare, shareData);\r\n    }\r\n\r\n    console.log(shareData);\r\n\r\n    return Promise.resolve()\r\n      .then(() => this._initWxSDK())\r\n      .then(() => this._ready())\r\n      .then(() => {\r\n        this.wx.onMenuShareAppMessage(shareData);\r\n        this.wx.onMenuShareTimeline(shareData);\r\n        this.wx.onMenuShareQQ(shareData);\r\n        this.wx.onMenuShareQZone(shareData);\r\n        this.wx.onMenuShareWeibo(shareData);\r\n      });\r\n  };\r\n\r\n  /**\r\n   * backToDefault\r\n   * @return {*}\r\n   */\r\n  backToDefault() {\r\n    return this.share();\r\n  };\r\n\r\n  /**\r\n   * init Wechat JSSDK\r\n   * @return {Promise<any>}\r\n   * @private\r\n   */\r\n  _initWxSDK() {\r\n    return new Promise(resolve => {\r\n      let _setWX = () => {\r\n        console.log('set wx');\r\n        let oScript = document.createElement(\"script\");\r\n        oScript.type = \"text/javascript\";\r\n        oScript.onload = () => {\r\n          this.wx = window.wx;\r\n          resolve();\r\n        };\r\n        oScript.src = WX_JSSDK_URL;\r\n        document.querySelector('head').appendChild(oScript);\r\n      };\r\n\r\n      if (this.wx) {\r\n        resolve();\r\n      } else {\r\n        if (window.wx) {\r\n          console.log('has wx');\r\n          this.wx = window.wx;\r\n          resolve();\r\n        } else {\r\n          _setWX();\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  /**\r\n   * set wx.config\r\n   * @return {Promise<any>}\r\n   * @private\r\n   */\r\n  _ready() {\r\n    return new Promise(resolve => {\r\n      if (this.isConfigReady) {\r\n        resolve();\r\n      } else {\r\n        console.log('set wx.config');\r\n        this.wx.config(this.wxConfig);\r\n\r\n        this.wx.ready(() => {\r\n          this.isConfigReady = true;\r\n\r\n          if (this.readyCallBack) {\r\n            this.readyCallBack();\r\n          }\r\n\r\n          resolve();\r\n        });\r\n      }\r\n    });\r\n  };\r\n};\r\n\r\n\r\n"],"sourceRoot":""}